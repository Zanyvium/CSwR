<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Computational Statistics with R</title>
  <meta name="description" content="Lecture notes providing an introduction to computational statistics using the R programming language.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Computational Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture notes providing an introduction to computational statistics using the R programming language." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Computational Statistics with R" />
  
  <meta name="twitter:description" content="Lecture notes providing an introduction to computational statistics using the R programming language." />
  

<meta name="author" content="Niels Richard Hansen">


<meta name="date" content="2018-08-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="importance-sampling.html">
<link rel="next" href="design-of-experiments.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational Statistics with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro-smooth.html"><a href="intro-smooth.html"><i class="fa fa-check"></i><b>1.1</b> Smoothing</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro-smooth.html"><a href="intro-smooth.html#intro-angles"><i class="fa fa-check"></i><b>1.1.1</b> Angle distributions in proteins</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro-smooth.html"><a href="intro-smooth.html#using-ggplot2"><i class="fa fa-check"></i><b>1.1.2</b> Using ggplot2</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro-smooth.html"><a href="intro-smooth.html#changing-the-defaults"><i class="fa fa-check"></i><b>1.1.3</b> Changing the defaults</a></li>
<li class="chapter" data-level="1.1.4" data-path="intro-smooth.html"><a href="intro-smooth.html#large-scale-smoothing"><i class="fa fa-check"></i><b>1.1.4</b> Large scale smoothing</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html"><i class="fa fa-check"></i><b>1.2</b> Monte Carlo Methods</a><ul>
<li class="chapter" data-level="1.2.1" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#univariate-von-mises-distributions"><i class="fa fa-check"></i><b>1.2.1</b> Univariate von Mises distributions</a></li>
<li class="chapter" data-level="1.2.2" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#mixtures-of-von-mises-distributions"><i class="fa fa-check"></i><b>1.2.2</b> Mixtures of von Mises distributions</a></li>
<li class="chapter" data-level="1.2.3" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#large-scale-simulation"><i class="fa fa-check"></i><b>1.2.3</b> Large scale simulation</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>1.3</b> Optimization</a><ul>
<li class="chapter" data-level="1.3.1" data-path="optimization.html"><a href="optimization.html#the-em-algorithm"><i class="fa fa-check"></i><b>1.3.1</b> The EM-algorithm</a></li>
<li class="chapter" data-level="1.3.2" data-path="optimization.html"><a href="optimization.html#large-scale-optimization"><i class="fa fa-check"></i><b>1.3.2</b> Large scale optimization</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.4</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#histograms-with-non-equidistant-breaks"><i class="fa fa-check"></i>Histograms with non-equidistant breaks</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Part I: Smoothing</b></span></li>
<li class="chapter" data-level="2" data-path="density.html"><a href="density.html"><i class="fa fa-check"></i><b>2</b> Density estimation</a><ul>
<li class="chapter" data-level="2.1" data-path="unidens.html"><a href="unidens.html"><i class="fa fa-check"></i><b>2.1</b> Univariate density estimation</a><ul>
<li class="chapter" data-level="2.1.1" data-path="unidens.html"><a href="unidens.html#likelihood"><i class="fa fa-check"></i><b>2.1.1</b> Likelihood considerations</a></li>
<li class="chapter" data-level="2.1.2" data-path="unidens.html"><a href="unidens.html#r-digression"><i class="fa fa-check"></i><b>2.1.2</b> R digression</a></li>
<li class="chapter" data-level="2.1.3" data-path="unidens.html"><a href="unidens.html#sieves"><i class="fa fa-check"></i><b>2.1.3</b> Method of sieves</a></li>
<li class="chapter" data-level="2.1.4" data-path="unidens.html"><a href="unidens.html#basis-density"><i class="fa fa-check"></i><b>2.1.4</b> Basis expansions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="kernel-density.html"><a href="kernel-density.html"><i class="fa fa-check"></i><b>2.2</b> Kernel methods</a><ul>
<li class="chapter" data-level="2.2.1" data-path="kernel-density.html"><a href="kernel-density.html#benchmarking"><i class="fa fa-check"></i><b>2.2.1</b> Benchmarking</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bandwidth.html"><a href="bandwidth.html"><i class="fa fa-check"></i><b>2.3</b> Bandwidth selection</a><ul>
<li class="chapter" data-level="2.3.1" data-path="bandwidth.html"><a href="bandwidth.html#revisiting-the-rectangular-kernel"><i class="fa fa-check"></i><b>2.3.1</b> Revisiting the rectangular kernel</a></li>
<li class="chapter" data-level="2.3.2" data-path="bandwidth.html"><a href="bandwidth.html#ise-mise-and-mse-for-kernel-estimators"><i class="fa fa-check"></i><b>2.3.2</b> ISE, MISE and MSE for kernel estimators</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="multivariate-smoothing.html"><a href="multivariate-smoothing.html"><i class="fa fa-check"></i><b>2.4</b> Multivariate methods</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bivariate.html"><a href="bivariate.html"><i class="fa fa-check"></i><b>3</b> Bivariate smoothing</a><ul>
<li class="chapter" data-level="3.1" data-path="running-means.html"><a href="running-means.html"><i class="fa fa-check"></i><b>3.1</b> Running means</a><ul>
<li class="chapter" data-level="3.1.1" data-path="running-means.html"><a href="running-means.html#dense-linear-algebra"><i class="fa fa-check"></i><b>3.1.1</b> Dense linear algebra</a></li>
<li class="chapter" data-level="3.1.2" data-path="running-means.html"><a href="running-means.html#direct-implementation"><i class="fa fa-check"></i><b>3.1.2</b> Direct implementation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="kernel-methods.html"><a href="kernel-methods.html"><i class="fa fa-check"></i><b>3.2</b> Kernel methods</a></li>
<li class="chapter" data-level="3.3" data-path="sparse-linear-algebra.html"><a href="sparse-linear-algebra.html"><i class="fa fa-check"></i><b>3.3</b> Sparse linear algebra</a></li>
<li class="chapter" data-level="3.4" data-path="orthogonal-basis-expansions.html"><a href="orthogonal-basis-expansions.html"><i class="fa fa-check"></i><b>3.4</b> Orthogonal basis expansions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="orthogonal-basis-expansions.html"><a href="orthogonal-basis-expansions.html#polynomial-expansions"><i class="fa fa-check"></i><b>3.4.1</b> Polynomial expansions</a></li>
<li class="chapter" data-level="3.4.2" data-path="orthogonal-basis-expansions.html"><a href="orthogonal-basis-expansions.html#fourier-expansions"><i class="fa fa-check"></i><b>3.4.2</b> Fourier expansions</a></li>
<li class="chapter" data-level="3.4.3" data-path="orthogonal-basis-expansions.html"><a href="orthogonal-basis-expansions.html#wavelets"><i class="fa fa-check"></i><b>3.4.3</b> Wavelets</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>3.5</b> Splines</a></li>
<li class="chapter" data-level="3.6" data-path="gaussian-processes.html"><a href="gaussian-processes.html"><i class="fa fa-check"></i><b>3.6</b> Gaussian processes</a></li>
<li class="chapter" data-level="3.7" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html"><i class="fa fa-check"></i><b>3.7</b> The Kalman filter</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#ar1-example"><i class="fa fa-check"></i><b>3.7.1</b> AR(1)-example</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#the-kalman-smoother"><i class="fa fa-check"></i><b>3.7.2</b> The Kalman smoother</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#implementation"><i class="fa fa-check"></i><b>3.7.3</b> Implementation</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#the-kalman-filter-1"><i class="fa fa-check"></i><b>3.7.4</b> The Kalman filter</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Part II: Monte Carlo Methods</b></span></li>
<li class="chapter" data-level="4" data-path="univariate-random-variables.html"><a href="univariate-random-variables.html"><i class="fa fa-check"></i><b>4</b> Univariate random variables</a><ul>
<li class="chapter" data-level="4.1" data-path="pseudo-random-numbers.html"><a href="pseudo-random-numbers.html"><i class="fa fa-check"></i><b>4.1</b> Pseudo random numbers</a></li>
<li class="chapter" data-level="4.2" data-path="transformation-techniques.html"><a href="transformation-techniques.html"><i class="fa fa-check"></i><b>4.2</b> Transformation techniques</a><ul>
<li class="chapter" data-level="4.2.1" data-path="transformation-techniques.html"><a href="transformation-techniques.html#sampling-from-a-t-distribution"><i class="fa fa-check"></i><b>4.2.1</b> Sampling from a <span class="math inline">\(t\)</span>-distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reject-samp.html"><a href="reject-samp.html"><i class="fa fa-check"></i><b>4.3</b> Rejection sampling</a><ul>
<li class="chapter" data-level="4.3.1" data-path="reject-samp.html"><a href="reject-samp.html#gamma-distribution"><i class="fa fa-check"></i><b>4.3.1</b> Gamma distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="MCI.html"><a href="MCI.html"><i class="fa fa-check"></i><b>5</b> Monte Carlo integration</a><ul>
<li class="chapter" data-level="5.1" data-path="assessment.html"><a href="assessment.html"><i class="fa fa-check"></i><b>5.1</b> Assessment</a><ul>
<li class="chapter" data-level="5.1.1" data-path="assessment.html"><a href="assessment.html#using-the-central-limit-theorem"><i class="fa fa-check"></i><b>5.1.1</b> Using the central limit theorem</a></li>
<li class="chapter" data-level="5.1.2" data-path="assessment.html"><a href="assessment.html#concentration-inequalities"><i class="fa fa-check"></i><b>5.1.2</b> Concentration inequalities</a></li>
<li class="chapter" data-level="5.1.3" data-path="assessment.html"><a href="assessment.html#exponential-tail-bound-for-gamma-distributed-variables"><i class="fa fa-check"></i><b>5.1.3</b> Exponential tail bound for Gamma distributed variables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="importance-sampling.html"><a href="importance-sampling.html"><i class="fa fa-check"></i><b>5.2</b> Importance sampling</a><ul>
<li class="chapter" data-level="5.2.1" data-path="importance-sampling.html"><a href="importance-sampling.html#unknown-normalization-constants"><i class="fa fa-check"></i><b>5.2.1</b> Unknown normalization constants</a></li>
<li class="chapter" data-level="5.2.2" data-path="importance-sampling.html"><a href="importance-sampling.html#computing-a-high-dimensional-integral"><i class="fa fa-check"></i><b>5.2.2</b> Computing a high-dimensional integral</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="network-failure.html"><a href="network-failure.html"><i class="fa fa-check"></i><b>5.3</b> Network failure</a><ul>
<li class="chapter" data-level="5.3.1" data-path="network-failure.html"><a href="network-failure.html#object-oriented-implementation"><i class="fa fa-check"></i><b>5.3.1</b> Object oriented implementation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="design-of-experiments.html"><a href="design-of-experiments.html"><i class="fa fa-check"></i><b>5.4</b> Design of experiments</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-random-variables.html"><a href="multivariate-random-variables.html"><i class="fa fa-check"></i><b>6</b> Multivariate random variables</a><ul>
<li class="chapter" data-level="6.1" data-path="sequential-simulation.html"><a href="sequential-simulation.html"><i class="fa fa-check"></i><b>6.1</b> Sequential simulation</a><ul>
<li class="chapter" data-level="6.1.1" data-path="sequential-simulation.html"><a href="sequential-simulation.html#sequential-mc-for-the-ar1-process"><i class="fa fa-check"></i><b>6.1.1</b> Sequential MC for the AR(1)-process</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="gaussian-random-variables.html"><a href="gaussian-random-variables.html"><i class="fa fa-check"></i><b>6.2</b> Gaussian random variables</a></li>
</ul></li>
<li class="part"><span><b>Part III: Optimization</b></span></li>
<li class="chapter" data-level="7" data-path="four-examples.html"><a href="four-examples.html"><i class="fa fa-check"></i><b>7</b> Four Examples</a><ul>
<li class="chapter" data-level="7.1" data-path="multinomial-models.html"><a href="multinomial-models.html"><i class="fa fa-check"></i><b>7.1</b> Multinomial models</a><ul>
<li class="chapter" data-level="7.1.1" data-path="multinomial-models.html"><a href="multinomial-models.html#peppered-moths"><i class="fa fa-check"></i><b>7.1.1</b> Peppered Moths</a></li>
<li class="chapter" data-level="7.1.2" data-path="multinomial-models.html"><a href="multinomial-models.html#multinomial-cell-collapsing"><i class="fa fa-check"></i><b>7.1.2</b> Multinomial cell collapsing</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="mixtures.html"><a href="mixtures.html"><i class="fa fa-check"></i><b>7.2</b> Mixtures</a><ul>
<li class="chapter" data-level="7.2.1" data-path="mixtures.html"><a href="mixtures.html#gaussian-mixtures"><i class="fa fa-check"></i><b>7.2.1</b> Gaussian mixtures</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html"><i class="fa fa-check"></i><b>7.3</b> Mixed effects models</a></li>
<li class="chapter" data-level="7.4" data-path="gaussian-state-space-models.html"><a href="gaussian-state-space-models.html"><i class="fa fa-check"></i><b>7.4</b> Gaussian state space models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="numerical-optimization.html"><a href="numerical-optimization.html"><i class="fa fa-check"></i><b>8</b> Numerical optimization</a><ul>
<li class="chapter" data-level="8.1" data-path="gradient-based-algorithms.html"><a href="gradient-based-algorithms.html"><i class="fa fa-check"></i><b>8.1</b> Gradient based algorithms</a><ul>
<li class="chapter" data-level="8.1.1" data-path="gradient-based-algorithms.html"><a href="gradient-based-algorithms.html#gradient-descent-and-conjugate-gradient"><i class="fa fa-check"></i><b>8.1.1</b> Gradient descent and conjugate gradient</a></li>
<li class="chapter" data-level="8.1.2" data-path="gradient-based-algorithms.html"><a href="gradient-based-algorithms.html#peppered-moths-1"><i class="fa fa-check"></i><b>8.1.2</b> Peppered Moths</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="newton-type-algorithms.html"><a href="newton-type-algorithms.html"><i class="fa fa-check"></i><b>8.2</b> Newton-type algorithms</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="EM.html"><a href="EM.html"><i class="fa fa-check"></i><b>9</b> Expectation Maximization algorithms</a><ul>
<li class="chapter" data-level="9.1" data-path="basic-properties.html"><a href="basic-properties.html"><i class="fa fa-check"></i><b>9.1</b> Basic properties</a><ul>
<li class="chapter" data-level="9.1.1" data-path="basic-properties.html"><a href="basic-properties.html#incomplete-data-likelihood"><i class="fa fa-check"></i><b>9.1.1</b> Incomplete data likelihood</a></li>
<li class="chapter" data-level="9.1.2" data-path="basic-properties.html"><a href="basic-properties.html#the-em-algorithm-is-ascending"><i class="fa fa-check"></i><b>9.1.2</b> The EM-algorithm is ascending</a></li>
<li class="chapter" data-level="9.1.3" data-path="basic-properties.html"><a href="basic-properties.html#multinomial-cell-collapsing-1"><i class="fa fa-check"></i><b>9.1.3</b> Multinomial cell collapsing</a></li>
<li class="chapter" data-level="9.1.4" data-path="basic-properties.html"><a href="basic-properties.html#peppered-moths-e--and-m-steps"><i class="fa fa-check"></i><b>9.1.4</b> Peppered Moths E- and M-steps</a></li>
<li class="chapter" data-level="9.1.5" data-path="basic-properties.html"><a href="basic-properties.html#inside-the-em"><i class="fa fa-check"></i><b>9.1.5</b> Inside the EM</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="EM-exp.html"><a href="EM-exp.html"><i class="fa fa-check"></i><b>9.2</b> Exponential families</a></li>
<li class="chapter" data-level="9.3" data-path="fisher-information.html"><a href="fisher-information.html"><i class="fa fa-check"></i><b>9.3</b> Fisher information</a></li>
<li class="chapter" data-level="9.4" data-path="two-examples-revisited.html"><a href="two-examples-revisited.html"><i class="fa fa-check"></i><b>9.4</b> Two examples revisited</a><ul>
<li class="chapter" data-level="9.4.1" data-path="two-examples-revisited.html"><a href="two-examples-revisited.html#gaussian-mixtures-1"><i class="fa fa-check"></i><b>9.4.1</b> Gaussian mixtures</a></li>
<li class="chapter" data-level="9.4.2" data-path="two-examples-revisited.html"><a href="two-examples-revisited.html#gaussian-state-space"><i class="fa fa-check"></i><b>9.4.2</b> Gaussian state space</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stochastic-optimization.html"><a href="stochastic-optimization.html"><i class="fa fa-check"></i><b>10</b> Stochastic Optimization</a><ul>
<li class="chapter" data-level="10.1" data-path="stochastic-gradient.html"><a href="stochastic-gradient.html"><i class="fa fa-check"></i><b>10.1</b> Stochastic gradient</a></li>
<li class="chapter" data-level="10.2" data-path="stochastic-em.html"><a href="stochastic-em.html"><i class="fa fa-check"></i><b>10.2</b> Stochastic EM</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="network-failure" class="section level2">
<h2><span class="header-section-number">5.3</span> Network failure</h2>
<p>Consider the following network consisting of ten nodes and with some of the nodes connected.</p>
<p><img src="figures/networkfig.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The network could be a computer network with ten computers. The different connections (edges) may “fail” independently with probability <span class="math inline">\(p\)</span>, and the question we will take an interest in is what is the probability that node 1 and node 10 become disconnected?</p>
<p>The network of nodes can be represented as a graph adjacency matrix <span class="math inline">\(A\)</span> such that <span class="math inline">\(A_{ij} = 1\)</span> if and only if there is an edge between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> (and <span class="math inline">\(A_{ij} = 0\)</span> otherwise).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A  ## Graph adjacency matrix</code></pre></div>
<pre><code>##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
##  [1,]    0    1    0    1    1    0    0    0    0     0
##  [2,]    1    0    1    0    0    1    0    0    0     0
##  [3,]    0    1    0    0    0    1    1    1    0     1
##  [4,]    1    0    0    0    1    0    0    1    0     0
##  [5,]    1    0    0    1    0    0    0    1    1     0
##  [6,]    0    1    1    0    0    0    1    0    0     1
##  [7,]    0    0    1    0    0    1    0    0    0     1
##  [8,]    0    0    1    1    1    0    0    0    1     0
##  [9,]    0    0    0    0    1    0    0    1    0     1
## [10,]    0    0    1    0    0    1    1    0    1     0</code></pre>
<p>To compute the probability that 1 and 10 become disconneted by Monte Carlo integration, we need to sample (sub)graphs by randomly removing some of the edges. This is implemented using the upper triangular part of the (symmetric) adjacency matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simNet &lt;-<span class="st"> </span><span class="cf">function</span>(Aup, p) {
  ones &lt;-<span class="st"> </span><span class="kw">which</span>(Aup <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
  Aup[ones] &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="kw">length</span>(ones), 
                      <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p))
  Aup <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(Aup)
}</code></pre></div>
<p>It is fairly fast to sample even a large number of random graphs this way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Aup &lt;-<span class="st"> </span>A
Aup[<span class="kw">lower.tri</span>(Aup)] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">system.time</span>(<span class="kw">replicate</span>(<span class="fl">1e5</span>, {<span class="kw">simNet</span>(Aup, <span class="fl">0.5</span>); <span class="ot">NULL</span>}))</code></pre></div>
<pre><code>##    user  system elapsed 
##   1.972   0.063   2.038</code></pre>
<p>The second function we need to implement checks network connectivity. It relies on the fact that there is a path from node 1 to node 10 consisting of <span class="math inline">\(k\)</span> edges if and only if <span class="math inline">\(A^k_{1,10} &gt; 0\)</span>. We see directly that such a path needs to consist of at least <span class="math inline">\(k = 3\)</span> edges. Also, we don’t need to check paths with more than <span class="math inline">\(k = 9\)</span> edges as they will contain the same node multiple times and can thus be shortened.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">disconAB &lt;-<span class="st"> </span><span class="cf">function</span>(A) {
  k &lt;-<span class="st"> </span><span class="dv">3</span>
  Apow &lt;-<span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>A ## A%^%3
  <span class="cf">while</span>(Apow[<span class="dv">1</span>, <span class="dv">10</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>k <span class="op">&lt;</span><span class="st"> </span><span class="dv">9</span>) {
    Apow &lt;-<span class="st"> </span>Apow <span class="op">%*%</span><span class="st"> </span>A
    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>    
  }
  Apow[<span class="dv">1</span>, <span class="dv">10</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>  ## TRUE if A and B not connected
}</code></pre></div>
<p>Estimating probability of nodes 1 and 10 being disconnected using<br />
Monte Carlo integration.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">seed &lt;-<span class="st"> </span><span class="dv">27092016</span>
<span class="kw">set.seed</span>(seed)
n &lt;-<span class="st"> </span><span class="fl">1e5</span>
tmp &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="kw">disconAB</span>(<span class="kw">simNet</span>(Aup, <span class="fl">0.05</span>)))
muhat &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp)</code></pre></div>
<p>As this is a (random) approximation, we should report not only the Monte Carlo estimate but also the confidence interval. Since the estimate is an average of 0-1-variables, we can estimate the variance, <span class="math inline">\(\sigma^2\)</span>, of the individual terms using that <span class="math inline">\(\sigma^2 = \mu (1 - \mu)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">muhat <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(muhat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>muhat) <span class="op">/</span><span class="st"> </span>n) <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 0.0002257328 0.0003400000 0.0004542672</code></pre>
<p>Importance sampling.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">impw &lt;-<span class="st"> </span><span class="cf">function</span>(Aup, A0, p, p0) {
  w &lt;-<span class="st"> </span><span class="kw">disconAB</span>(A0)
  <span class="cf">if</span> (w) {
    b &lt;-<span class="st"> </span><span class="dv">18</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(Aup[A0 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])
    w &lt;-<span class="st"> </span>((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p0) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p))<span class="op">^</span><span class="dv">18</span> <span class="op">*</span><span class="st"> </span>
<span class="st">      </span>(p0 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p) <span class="op">/</span><span class="st"> </span>(p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p0)))<span class="op">^</span>b
  }
  <span class="kw">as.numeric</span>(w)
}</code></pre></div>
<p>This uses formula (6.48) in the book for computing the importance weights. For the IS estimator they are multiplied by the indicator that A and B are disconnected.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(seed)
tmp &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="kw">impw</span>(Aup, <span class="kw">simNet</span>(Aup, <span class="fl">0.2</span>), <span class="fl">0.2</span>, <span class="fl">0.05</span>))
muhatIS &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp)</code></pre></div>
<p>Confidence interval using empirical variance estimate <span class="math inline">\(\hat{\sigma}^2\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">muhatIS <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(tmp) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n) <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 0.0002619838 0.0002960900 0.0003301962</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">sd</span>(tmp), <span class="kw">sqrt</span>(muhat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>muhat))) ## The two standard deviations</code></pre></div>
<pre><code>## [1] 0.005502716 0.018435954</code></pre>
<p>The ratio of variances is estimated as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">muhat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>muhat) <span class="op">/</span><span class="st"> </span><span class="kw">var</span>(tmp)</code></pre></div>
<pre><code>## [1] 11.22476</code></pre>
<p>We need around 11 times more naive samples when compared to importance sampling to obtain the same precision. A benchmark will show that the extra computing time for importance sampling is small compared to the reduction of variance. It is worth the coding effort if used repeatedly, but not if it is a one-off computation.</p>
<p>The graph is small enough for complete enumeration and thus the computation of an exact solution. There are <span class="math inline">\(2^{18} = 262,144\)</span> different networks with any number of the edges failing, so complete enumeration is possible. To systematically walk through each possible combination of edges failing, we use the function <code>intToBits</code> that convert an integer to its binary representation for integers from 0 to 262,143. This is a quick and convenient way of representing all the different fail and non-fail combinations for the edges.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ones &lt;-<span class="st"> </span><span class="kw">which</span>(Aup <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
p &lt;-<span class="st"> </span><span class="fl">0.05</span>
prob &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">18</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">18</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)) {
  on &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">intToBits</span>(i)[<span class="dv">1</span><span class="op">:</span><span class="dv">18</span>])
  nr &lt;-<span class="st"> </span><span class="kw">sum</span>(on)
  Atmp &lt;-<span class="st"> </span>Aup
  Atmp[ones] &lt;-<span class="st"> </span>on
  <span class="cf">if</span>(<span class="kw">disconAB</span>(Atmp <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(Atmp)))
    prob[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span>p<span class="op">^</span>(<span class="dv">18</span> <span class="op">-</span><span class="st"> </span>nr) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p)<span class="op">^</span>nr
}</code></pre></div>
<p>The probability of nodes 1 and 10 disconnected can then be computed as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(prob)</code></pre></div>
<pre><code>## [1] 0.000288295</code></pre>
<p>This number should be compared to the estimates computed above. For a more complete comparison, we have used importance sampling with edge fail probability ranging from 0.1 to 0.4, see Figure <a href="network-failure.html#fig:networkImp">5.3</a>. The results show that a failure probability of 0.2 is close to optimal in terms of giving an importance sampling estimate with minimal variance. For smaller values, the event that 1 and 10 become disconnected is too rare, and for larger values the importance weights become too variable. A choice of 0.2 strikes a good balance.</p>

<div class="figure" style="text-align: center"><span id="fig:networkImp"></span>
<img src="CSwR_files/figure-html/networkImp-1.png" alt="Confidence intervals for importance sampling estimates of network nodes 1 and 10 being disconnected under independent edge failures with probability 0.05. The red line is the true probability computed by complete enumeration." width="70%" />
<p class="caption">
Figure 5.3: Confidence intervals for importance sampling estimates of network nodes 1 and 10 being disconnected under independent edge failures with probability 0.05. The red line is the true probability computed by complete enumeration.
</p>
</div>
<div id="object-oriented-implementation" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Object oriented implementation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">network &lt;-<span class="st"> </span><span class="cf">function</span>(A, p) {
  Aup &lt;-<span class="st"> </span>A
  Aup[<span class="kw">lower.tri</span>(Aup)] &lt;-<span class="st"> </span><span class="dv">0</span> 
  ones &lt;-<span class="st"> </span><span class="kw">which</span>((Aup <span class="op">==</span><span class="st"> </span><span class="dv">1</span>))
  <span class="kw">structure</span>(<span class="kw">list</span>(<span class="dt">A =</span> A, <span class="dt">Aup =</span> Aup, <span class="dt">ones =</span> ones, <span class="dt">p =</span> p), 
            <span class="dt">class =</span> <span class="st">&quot;network&quot;</span>)
}
myNet &lt;-<span class="st"> </span><span class="kw">network</span>(A, <span class="dt">p =</span> <span class="fl">0.05</span>)
<span class="kw">str</span>(myNet)</code></pre></div>
<pre><code>## List of 4
##  $ A   : num [1:10, 1:10] 0 1 0 1 1 0 0 0 0 0 ...
##  $ Aup : num [1:10, 1:10] 0 0 0 0 0 0 0 0 0 0 ...
##  $ ones: int [1:18] 11 22 31 41 44 52 53 63 66 73 ...
##  $ p   : num 0.05
##  - attr(*, &quot;class&quot;)= chr &quot;network&quot;</code></pre>
<p>Generic functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...)
  <span class="kw">UseMethod</span>(<span class="st">&quot;sim&quot;</span>)
failure &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...)
  <span class="kw">UseMethod</span>(<span class="st">&quot;failure&quot;</span>)</code></pre></div>
<p>The first method</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim.network &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  Aup &lt;-<span class="st"> </span>x<span class="op">$</span>Aup
  Aup[x<span class="op">$</span>ones] &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="kw">length</span>(x<span class="op">$</span>ones), 
                        <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(x<span class="op">$</span>p, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x<span class="op">$</span>p))
  Aup <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(Aup)
}</code></pre></div>
<p>and the second method</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">failure.network &lt;-<span class="st"> </span><span class="cf">function</span>(x, n, <span class="dt">p =</span> <span class="ot">NULL</span>) {
  <span class="cf">if</span> (<span class="kw">is.null</span>(p)) { ## Naive simulation
    tmp &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="kw">disconAB</span>(<span class="kw">sim</span>(x)))
    muhat &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp)
    se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(muhat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>muhat) <span class="op">/</span><span class="st"> </span>n)
  } <span class="cf">else</span> { ## Importance sampling
    p0 &lt;-<span class="st"> </span>x<span class="op">$</span>p
    x<span class="op">$</span>p &lt;-<span class="st"> </span>p
    tmp &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="kw">impw</span>(x<span class="op">$</span>Aup, <span class="kw">sim</span>(x), p, p0))
    se &lt;-<span class="st"> </span><span class="kw">sd</span>(tmp) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)
    muhat &lt;-<span class="st"> </span><span class="kw">mean</span>(tmp)
  } 
  value &lt;-<span class="st"> </span>muhat <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)  
  <span class="kw">names</span>(value) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;estimate&quot;</span>, <span class="st">&quot;high&quot;</span>)
  value
}</code></pre></div>
<p>Test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(seed)  ## Resetting seed
<span class="kw">failure</span>(myNet, n)</code></pre></div>
<pre><code>##          low     estimate         high 
## 0.0002257328 0.0003400000 0.0004542672</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(seed)  ## Resetting seed
<span class="kw">failure</span>(myNet, n, <span class="dt">p =</span> <span class="fl">0.2</span>)</code></pre></div>
<pre><code>##          low     estimate         high 
## 0.0002619838 0.0002960900 0.0003301962</code></pre>
<p>Check that the results are the same as on ??.</p>
<p>Benchmarking</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">replicate</span>(<span class="fl">1e5</span>, {<span class="kw">simNet</span>(Aup, <span class="fl">0.5</span>); <span class="ot">NULL</span>}))</code></pre></div>
<pre><code>##    user  system elapsed 
##   1.961   0.064   2.030</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">replicate</span>(<span class="fl">1e5</span>, {<span class="kw">sim</span>(myNet); <span class="ot">NULL</span>}))</code></pre></div>
<pre><code>##    user  system elapsed 
##   2.181   0.048   2.233</code></pre>
<p>One should expect a small computational overhead due to method dispatching, that is, the procedure that R uses to look up the appropriate <code>sim</code> method for an object of class <code>network</code>. This is done 100,000 times in the benchmark example above. In this case, that overhead is almost negligible.</p>
<p>The generic <code>print</code> function already exists. We implement a method for class <code>network</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">print.network &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">cat</span>(<span class="st">&quot;#vertices: &quot;</span>, <span class="kw">nrow</span>(x<span class="op">$</span>A), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;#edges:&quot;</span>, <span class="kw">sum</span>(x<span class="op">$</span>Aup), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;p = &quot;</span>, x<span class="op">$</span>p, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myNet  ## Implicitly calls &#39;print&#39;</code></pre></div>
<pre><code>## #vertices:  10 
## #edges: 18 
## p =  0.05</code></pre>
<p>Using igraph.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(igraph)
net &lt;-<span class="st"> </span><span class="kw">graph_from_adjacency_matrix</span>(A, <span class="dt">mode =</span> <span class="st">&quot;undirected&quot;</span>)
net</code></pre></div>
<pre><code>## IGRAPH afa7fc6 U--- 10 18 -- 
## + edges from afa7fc6:
##  [1] 1-- 2 1-- 4 1-- 5 2-- 3 2-- 6 3-- 6 3-- 7 3-- 8 3--10 4-- 5 4-- 8
## [12] 5-- 8 5-- 9 6-- 7 6--10 7--10 8-- 9 9--10</code></pre>
<p>The igraph package supports a vast number of graph computation, manipulation and visualization tools.</p>
<p>Plotting an igraph.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## You can generate a layout ...
net_layout &lt;-<span class="st"> </span><span class="kw">layout_</span>(net, <span class="kw">nicely</span>())
## ... or you can specify one yourself 
net_layout &lt;-<span class="st"> </span><span class="kw">matrix</span>(
  <span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,  <span class="dv">1</span>,
    <span class="op">-</span><span class="dv">4</span>,  <span class="dv">3</span>,
    <span class="op">-</span><span class="dv">4</span>,  <span class="dv">1</span>,
    <span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>,
    <span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">3</span>,
     <span class="dv">4</span>,  <span class="dv">3</span>,
     <span class="dv">4</span>,  <span class="dv">1</span>,
     <span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>,
     <span class="dv">4</span>, <span class="op">-</span><span class="dv">3</span>,
     <span class="dv">20</span>,  <span class="op">-</span><span class="dv">1</span>),
  <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">10</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Plotting an igraph</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(net, <span class="dt">layout =</span> net_layout, <span class="dt">asp =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="CSwR_files/figure-html/network_plot-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Simulation method for igraph</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim.igraph &lt;-<span class="st"> </span><span class="cf">function</span>(x, p) {
  nr &lt;-<span class="st"> </span><span class="kw">ecount</span>(x)
  deledges &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), nr, 
                     <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p))
  <span class="kw">delete_edges</span>(x, <span class="kw">which</span>(deledges))
}</code></pre></div>
<p>A simulated graph</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">sim</span>(net, <span class="fl">0.25</span>), <span class="dt">layout =</span> net_layout, <span class="dt">asp =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="CSwR_files/figure-html/network_simulated-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This is slower than using the matrix representation alone as in <code>simNet</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">replicate</span>(<span class="fl">1e5</span>, {<span class="kw">sim</span>(net, <span class="fl">0.5</span>); <span class="ot">NULL</span>}))</code></pre></div>
<pre><code>##    user  system elapsed 
##   3.945   1.382   5.334</code></pre>
<p>One could also implement the function for testing if nodes 1 and 10 are disconnected using the <code>shortest_paths</code> function, but this is not faster than the simple matrix multiplications used in <code>disconAB</code> either, though it could be for larger graphs.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="importance-sampling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="design-of-experiments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
