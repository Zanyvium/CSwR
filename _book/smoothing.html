<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Computational Statistics with R</title>
  <meta name="description" content="Lecture notes providing an introduction to computational statistics using the R programming language.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Computational Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture notes providing an introduction to computational statistics using the R programming language." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Computational Statistics with R" />
  
  <meta name="twitter:description" content="Lecture notes providing an introduction to computational statistics using the R programming language." />
  

<meta name="author" content="Niels Richard Hansen">


<meta name="date" content="2018-03-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="monte-carlo-methods.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational Statistics with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>1.1</b> Smoothing</a><ul>
<li class="chapter" data-level="1.1.1" data-path="smoothing.html"><a href="smoothing.html#angle-distributions-in-proteins"><i class="fa fa-check"></i><b>1.1.1</b> Angle distributions in proteins</a></li>
<li class="chapter" data-level="1.1.2" data-path="smoothing.html"><a href="smoothing.html#using-ggplot2"><i class="fa fa-check"></i><b>1.1.2</b> Using ggplot2</a></li>
<li class="chapter" data-level="1.1.3" data-path="smoothing.html"><a href="smoothing.html#large-scale-smoothing"><i class="fa fa-check"></i><b>1.1.3</b> Large scale smoothing</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html"><i class="fa fa-check"></i><b>1.2</b> Monte Carlo Methods</a></li>
<li class="chapter" data-level="1.3" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>1.3</b> Optimization</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-smoothing.html"><a href="part-i-smoothing.html"><i class="fa fa-check"></i>Part I: Smoothing</a></li>
<li class="chapter" data-level="2" data-path="density-estimation.html"><a href="density-estimation.html"><i class="fa fa-check"></i><b>2</b> Density Estimation</a><ul>
<li class="chapter" data-level="2.1" data-path="univariate-kernel-methods.html"><a href="univariate-kernel-methods.html"><i class="fa fa-check"></i><b>2.1</b> Univariate kernel methods</a></li>
<li class="chapter" data-level="2.2" data-path="bandwidth-selection.html"><a href="bandwidth-selection.html"><i class="fa fa-check"></i><b>2.2</b> Bandwidth selection</a></li>
<li class="chapter" data-level="2.3" data-path="multivariate-methods.html"><a href="multivariate-methods.html"><i class="fa fa-check"></i><b>2.3</b> Multivariate methods</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bivariate-smoothing.html"><a href="bivariate-smoothing.html"><i class="fa fa-check"></i><b>3</b> Bivariate smoothing</a><ul>
<li class="chapter" data-level="3.1" data-path="running-means.html"><a href="running-means.html"><i class="fa fa-check"></i><b>3.1</b> Running means</a><ul>
<li class="chapter" data-level="3.1.1" data-path="running-means.html"><a href="running-means.html#dense-linear-algebra"><i class="fa fa-check"></i><b>3.1.1</b> Dense linear algebra</a></li>
<li class="chapter" data-level="3.1.2" data-path="running-means.html"><a href="running-means.html#direct-implementation"><i class="fa fa-check"></i><b>3.1.2</b> Direct implementation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="kernel-methods.html"><a href="kernel-methods.html"><i class="fa fa-check"></i><b>3.2</b> Kernel methods</a></li>
<li class="chapter" data-level="3.3" data-path="sparse-linear-algebra.html"><a href="sparse-linear-algebra.html"><i class="fa fa-check"></i><b>3.3</b> Sparse linear algebra</a></li>
<li class="chapter" data-level="3.4" data-path="orthogonal-basis-expansions.html"><a href="orthogonal-basis-expansions.html"><i class="fa fa-check"></i><b>3.4</b> Orthogonal basis expansions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="orthogonal-basis-expansions.html"><a href="orthogonal-basis-expansions.html#polynomial-expansions"><i class="fa fa-check"></i><b>3.4.1</b> Polynomial expansions</a></li>
<li class="chapter" data-level="3.4.2" data-path="orthogonal-basis-expansions.html"><a href="orthogonal-basis-expansions.html#fourier-expansions"><i class="fa fa-check"></i><b>3.4.2</b> Fourier expansions</a></li>
<li class="chapter" data-level="3.4.3" data-path="orthogonal-basis-expansions.html"><a href="orthogonal-basis-expansions.html#wavelets"><i class="fa fa-check"></i><b>3.4.3</b> Wavelets</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>3.5</b> Splines</a></li>
<li class="chapter" data-level="3.6" data-path="gaussian-processes.html"><a href="gaussian-processes.html"><i class="fa fa-check"></i><b>3.6</b> Gaussian processes</a></li>
<li class="chapter" data-level="3.7" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html"><i class="fa fa-check"></i><b>3.7</b> The Kalman filter</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#ar1-example"><i class="fa fa-check"></i><b>3.7.1</b> AR(1)-example</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#the-kalman-smoother"><i class="fa fa-check"></i><b>3.7.2</b> The Kalman smoother</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#implementation"><i class="fa fa-check"></i><b>3.7.3</b> Implementation</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#the-kalman-filter-1"><i class="fa fa-check"></i><b>3.7.4</b> The Kalman filter</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-kalman-filter.html"><a href="the-kalman-filter.html#simulated-example"><i class="fa fa-check"></i><b>3.7.5</b> Simulated example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-monte-carlo-methods.html"><a href="part-ii-monte-carlo-methods.html"><i class="fa fa-check"></i>Part II: Monte Carlo Methods</a></li>
<li class="chapter" data-level="4" data-path="univariate-random-variables.html"><a href="univariate-random-variables.html"><i class="fa fa-check"></i><b>4</b> Univariate random variables</a><ul>
<li class="chapter" data-level="4.1" data-path="pseudo-random-numbers.html"><a href="pseudo-random-numbers.html"><i class="fa fa-check"></i><b>4.1</b> Pseudo Random numbers</a></li>
<li class="chapter" data-level="4.2" data-path="transformation-techniques.html"><a href="transformation-techniques.html"><i class="fa fa-check"></i><b>4.2</b> Transformation techniques</a></li>
<li class="chapter" data-level="4.3" data-path="rejection-sampling.html"><a href="rejection-sampling.html"><i class="fa fa-check"></i><b>4.3</b> Rejection sampling</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-random-variables.html"><a href="multivariate-random-variables.html"><i class="fa fa-check"></i><b>5</b> Multivariate random variables</a><ul>
<li class="chapter" data-level="5.1" data-path="sequential-simulation.html"><a href="sequential-simulation.html"><i class="fa fa-check"></i><b>5.1</b> Sequential simulation</a></li>
<li class="chapter" data-level="5.2" data-path="gaussian-random-variables.html"><a href="gaussian-random-variables.html"><i class="fa fa-check"></i><b>5.2</b> Gaussian random variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="monte-carlo-integration.html"><a href="monte-carlo-integration.html"><i class="fa fa-check"></i><b>6</b> Monte Carlo Integration</a><ul>
<li class="chapter" data-level="6.1" data-path="assessment.html"><a href="assessment.html"><i class="fa fa-check"></i><b>6.1</b> Assessment</a></li>
<li class="chapter" data-level="6.2" data-path="importance-sampling.html"><a href="importance-sampling.html"><i class="fa fa-check"></i><b>6.2</b> Importance sampling</a></li>
<li class="chapter" data-level="6.3" data-path="design-of-experiments.html"><a href="design-of-experiments.html"><i class="fa fa-check"></i><b>6.3</b> Design of experiments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-optimization.html"><a href="part-iii-optimization.html"><i class="fa fa-check"></i>Part III: Optimization</a></li>
<li class="chapter" data-level="7" data-path="four-examples.html"><a href="four-examples.html"><i class="fa fa-check"></i><b>7</b> Four Examples</a><ul>
<li class="chapter" data-level="7.1" data-path="multinomial-models.html"><a href="multinomial-models.html"><i class="fa fa-check"></i><b>7.1</b> Multinomial models</a></li>
<li class="chapter" data-level="7.2" data-path="gaussian-mixtures.html"><a href="gaussian-mixtures.html"><i class="fa fa-check"></i><b>7.2</b> Gaussian mixtures</a></li>
<li class="chapter" data-level="7.3" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html"><i class="fa fa-check"></i><b>7.3</b> Mixed effects models</a></li>
<li class="chapter" data-level="7.4" data-path="gaussian-state-space-models.html"><a href="gaussian-state-space-models.html"><i class="fa fa-check"></i><b>7.4</b> Gaussian state space models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="numerical-optimization.html"><a href="numerical-optimization.html"><i class="fa fa-check"></i><b>8</b> Numerical optimization</a><ul>
<li class="chapter" data-level="8.1" data-path="gradient-based-algorithms.html"><a href="gradient-based-algorithms.html"><i class="fa fa-check"></i><b>8.1</b> Gradient based algorithms</a></li>
<li class="chapter" data-level="8.2" data-path="newton-type-algorithms.html"><a href="newton-type-algorithms.html"><i class="fa fa-check"></i><b>8.2</b> Newton-type algorithms</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="expectation-maximization-algorithms.html"><a href="expectation-maximization-algorithms.html"><i class="fa fa-check"></i><b>9</b> Expectation Maximization algorithms</a><ul>
<li class="chapter" data-level="9.1" data-path="basic-properties.html"><a href="basic-properties.html"><i class="fa fa-check"></i><b>9.1</b> Basic properties</a></li>
<li class="chapter" data-level="9.2" data-path="fisher-information.html"><a href="fisher-information.html"><i class="fa fa-check"></i><b>9.2</b> Fisher information</a></li>
<li class="chapter" data-level="9.3" data-path="two-examples-revisited.html"><a href="two-examples-revisited.html"><i class="fa fa-check"></i><b>9.3</b> Two examples revisited</a><ul>
<li class="chapter" data-level="9.3.1" data-path="two-examples-revisited.html"><a href="two-examples-revisited.html#gaussian-mixtures-1"><i class="fa fa-check"></i><b>9.3.1</b> Gaussian mixtures</a></li>
<li class="chapter" data-level="9.3.2" data-path="two-examples-revisited.html"><a href="two-examples-revisited.html#gaussian-state-space"><i class="fa fa-check"></i><b>9.3.2</b> Gaussian state space</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stochastic-optimization.html"><a href="stochastic-optimization.html"><i class="fa fa-check"></i><b>10</b> Stochastic Optimization</a><ul>
<li class="chapter" data-level="10.1" data-path="stochastic-gradient.html"><a href="stochastic-gradient.html"><i class="fa fa-check"></i><b>10.1</b> Stochastic gradient</a></li>
<li class="chapter" data-level="10.2" data-path="stochastic-em.html"><a href="stochastic-em.html"><i class="fa fa-check"></i><b>10.2</b> Stochastic EM</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="smoothing" class="section level2">
<h2><span class="header-section-number">1.1</span> Smoothing</h2>
<p>Smoothing is a descriptive statistical tool for summarizing data, a practical visualization technique, as well as a nonparametric estimation methodology.</p>
<div id="angle-distributions-in-proteins" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Angle distributions in proteins</h3>
<p>We will illustrate smoothing using a small data set on angles formed between two subsequent peptide planes in 3D protein structures.</p>

<div class="figure" style="text-align: center"><span id="fig:phipsiangles"></span>
<img src="PhiPsi_creative.jpg" alt="The 3D structure of proteins is largely given by the \(\phi\)- and \(\psi\)-angles of the peptide planes. (By Dcrjsr, CC BY 3.0 via Wikimedia Commons.)" width="40%" />
<p class="caption">
Figure 1.1: The 3D structure of proteins is largely given by the <span class="math inline">\(\phi\)</span>- and <span class="math inline">\(\psi\)</span>-angles of the peptide planes. (By <a href="https://commons.wikimedia.org/wiki/File%3APhiPsi_drawing_with_plane_and_labels.jpg">Dcrjsr</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> via Wikimedia Commons.)
</p>
</div>
<p>A protein is a large molecule consisting of a backbone with carbon and nitrogen atoms arranged sequentially: <img src="backbone.png" width="70%" style="display: block; margin: auto;" /></p>
<p>A hydrogen atom binds to each nitrogen (N) and an oxygen atom binds to each carbon without the <span class="math inline">\(\alpha\)</span> subscript (C), see Figure <a href="smoothing.html#fig:phipsiangles">1.1</a>, and such four atoms form together what is known as a peptide bond between two alpha-carbon atoms (C<span class="math inline">\(_{\alpha}\)</span>). Each C<span class="math inline">\(_{\alpha}\)</span> atom binds a hydrogen atom and an amino acid <em>side chain</em>. There are 20 naturally occurring amino acids in genetically encoded proteins, each having a three letter code (such as Gly for Glycine, Pro for Proline, etc.). The protein will typically form a complicated 3D structure determined by the amino acids, which in turn determine the <span class="math inline">\(\phi\)</span>- and the <span class="math inline">\(\psi\)</span>-angles between the peptide planes as shown on Figure <a href="smoothing.html#fig:phipsiangles">1.1</a>.</p>
<p>We will consider a small data set, <code>phipsi</code>, of experimentally determined angles from a single protein, the human protein <a href="https://www.rcsb.org/structure/1HMP">1HMP</a>, which is composed of two chains (denoted A and B). Figure <a href="smoothing.html#fig:1HMP">1.2</a> shows the 3D structure of the protein.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(phipsi)</code></pre></div>
<pre><code>##   chain  AA pos        phi        psi
## 1     A Pro   5 -1.6218794  0.2258685
## 2     A Gly   6  1.1483709 -2.8314426
## 3     A Val   7 -1.4160220  2.1190570
## 4     A Val   8 -1.4926720  2.3941331
## 5     A Ile   9 -2.1814653  1.4877618
## 6     A Ser  10 -0.7525375  2.5676186</code></pre>
<div class="figure" style="text-align: center"><span id="fig:1HMP"></span>
<img src="1HMP.png" alt="The 3D structure of the atoms constituting the protein 1HMP. The colors indicate the two different chains." width="30%" />
<p class="caption">
Figure 1.2: The 3D structure of the atoms constituting the protein 1HMP. The colors indicate the two different chains.
</p>
</div>
<p>We can use base R functions such as <code>hist</code> and <code>density</code> to visualize the marginal distributions of the two angles.</p>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(phipsi<span class="op">$</span>phi, <span class="dt">prob =</span> <span class="ot">TRUE</span>)
<span class="kw">rug</span>(phipsi<span class="op">$</span>phi)
<span class="kw">lines</span>(<span class="kw">density</span>(phipsi<span class="op">$</span>phi), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">hist</span>(phipsi<span class="op">$</span>psi, <span class="dt">prob =</span> <span class="ot">TRUE</span>)
<span class="kw">rug</span>(phipsi<span class="op">$</span>psi)
<span class="kw">lines</span>(<span class="kw">density</span>(phipsi<span class="op">$</span>psi), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:phipsiDens"></span>
<img src="CSwR_files/figure-html/phipsiDens-1.png" alt="Histograms equipped with a rug plot and smoothed density estimate (red line) of the distribution of \(\phi\)-angles (left) and \(\psi\)-angles (right)." width="49%" /><img src="CSwR_files/figure-html/phipsiDens-2.png" alt="Histograms equipped with a rug plot and smoothed density estimate (red line) of the distribution of \(\phi\)-angles (left) and \(\psi\)-angles (right)." width="49%" />
<p class="caption">
Figure 1.3: Histograms equipped with a rug plot and smoothed density estimate (red line) of the distribution of <span class="math inline">\(\phi\)</span>-angles (left) and <span class="math inline">\(\psi\)</span>-angles (right).
</p>
</div>
<p>The smooth red density curve shown in Figure <a href="smoothing.html#fig:phipsiDens">1.3</a> can be thought of as a smooth version of a histogram. It is surprisingly difficult to find automatic smoothing procedures that perform uniformly well – it is even quite difficult to automatically select the number and positions of the breaks used for histograms. This is one of the important points that is taken up in this book: how to implement good default choices of various <em>tuning parameters</em> that are required by any smoothing procedure.</p>
</div>
<div id="using-ggplot2" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Using ggplot2</h3>
<p>It is also possible to use <code>ggplot2</code> to achieve similar results.</p>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(phipsi, <span class="kw">aes</span>(<span class="dt">x =</span> phi)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">13</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_rug</span>()
<span class="kw">ggplot</span>(phipsi, <span class="kw">aes</span>(<span class="dt">x =</span> psi)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">13</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_rug</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:phipsiggplot"></span>
<img src="CSwR_files/figure-html/phipsiggplot-1.png" alt="Histograms and density estimates of \(\phi\)-angles (left) and \(\psi\)-angles (right) made with ggplot2." width="49%" /><img src="CSwR_files/figure-html/phipsiggplot-2.png" alt="Histograms and density estimates of \(\phi\)-angles (left) and \(\psi\)-angles (right) made with ggplot2." width="49%" />
<p class="caption">
Figure 1.4: Histograms and density estimates of <span class="math inline">\(\phi\)</span>-angles (left) and <span class="math inline">\(\psi\)</span>-angles (right) made with ggplot2.
</p>
</div>
<p>Histograms produced by ggplot2 have a non adaptive default number of bins equal to 30 (number of breaks equal to 31), which is different from <code>hist</code> that uses the data adaptive Sturges’ formula <span class="math display">\[\text{number of breaks} = \lceil \log_2(n) + 1 \rceil\]</span> with <span class="math inline">\(n\)</span> the number of samples in the data set. In addition, this number is further modified by the function <code>pretty</code> that generates “nice” breaks, which results in 14 breaks for the angle data. For easy comparison, the number of bins used by <code>ggplot</code> is thus set to 13. The authors of the ggplot2 implementation know that automatic and data adaptive bin selection is difficult. Instead, in case the fixed, and likely suboptimal, default is used, the user is notified that this choice can be improved by setting <code>binwidth</code>.</p>
<p>For the density, <code>ggplot</code> actually relies on the <code>density</code> function and its default choices of how and how much to smooth. Thus the figure may have a slightly different appearance, but the estimated density obtained by <code>geom_density</code> is identical to the one obtained by <code>density</code>. For the <span class="math inline">\(\psi\)</span>-angle it appears that the defaults result in oversmoothing. That is, the density is more smoothed out than the data (and the histogram) appears to support.</p>
</div>
<div id="large-scale-smoothing" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Large scale smoothing</h3>
<p>Relations to computations with large scale data. Ex. Spark / Hadoop, high-dim. problems.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="monte-carlo-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["CSwR.pdf", "CSwR.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
